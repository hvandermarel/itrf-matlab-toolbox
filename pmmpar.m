function [omega_xyz,orb,defpmm]=pmmpar(pmm,tecplate)
%PMMPAR   Get Plate Motion Model parameters.
%   [OMEGA_XYZ,ORB]=PMMPAR(PMM,TECPLATE) returns the Cartesian plate rotation
%   vector OMEGA_XYZ in deg/My and the so-called Origin Rotation Bias ORB
%   for the selected plate motion model PMM and tectonic plate TECPLATE.
%
%   Currently supported plate motion models are "NUVEL 1A NNR", "ITRF2000", "ITRF2008",
%   "ITRF2014", "ITRF2020", "GSRM 2.1 IGS08" and "GSRM 2.1 NNR". The tectonic plate
%   can be specific by it's full name, a 2-letter (available for all plates) or 
%   4-letter abbreviation (available for some plates).  
%
%   The Origin Rotation Bias ORB is only meaningful for ITRF PMM.
%  
%   [OMEGA_XYZ,ORB,DEFPMM]=PMMPAR(PMM,TECPLATE) returns also the structure array
%   DEFPMM with the full plate motion model definition.
%
%   Examples:
%
%      [ omega_xyz, orb ] = pmmpar('ITRF2020','EURA');
%      [ omega_xyz, orb ] = pmmpar('ITRF2020','Eurasia');
%      omega_xyz = pmmpar('GSRM 2.1 NNR','EU');
%
%   See also PMMVEL
%
%   (c) Hans van der Marel, Delft University of Technology, 2025.

% NUVEL 1A 	DeMets, Gordon, Argus, and Stein [1994]

defpmm(1).model='NUVEL 1A NNR';
defpmm(1).partype='omega_xyz'; 
defpmm(1).parunits='deg/My';
% Rotation vectors given in rad/My and wrt to pacific plate
defpmm(1).data={ ...
   'Africa'        , 'AF' , 'NUBI' ,  0.00240  , -0.007939 , 0.013892 ; ...
   'Antarctica'    , 'AN' , 'ANTA' ,  0.000689 , -0.006541 , 0.013676 ; ...
   'Arabia'        , 'AR' , 'ARAB' ,  0.008195 , -0.005361 , 0.016730 ; ...
   'Australia'     , 'AU' , 'AUST' ,  0.009349 ,  0.000284 , 0.016252 ; ...
   'Caribbean'     , 'CA' , 'CARB' ,  0.001332 , -0.008225 , 0.011551 ; ...
   'Cocos'         , 'CO' , '    ' , -0.008915 , -0.026445 , 0.020895 ; ...
   'Eurasia'       , 'EU' , 'EURA' ,  0.000529 , -0.007235 , 0.013123 ; ...
   'India'         , 'IN' , 'INDI' ,  0.008180 , -0.004800 , 0.016760 ; ...
   'Nazca'         , 'NZ' , 'NAZC' , -0.000022 , -0.013417 , 0.019579 ; ...
   'NorthAmerica'  , 'NA' , 'NOAM' ,  0.001768 , -0.008439 , 0.009817 ; ...
   'Pacific'       , 'PA' , 'PCFC' ,  0.0      ,  0.0      , 0.0      ; ...
   'SouthAmerica'  , 'SA' , 'SOAM' ,  0.000472 , -0.006355 , 0.009100 };
defpmm(1).orb=[0 , 0 , 0];
% Add NNR to all plates and convert rad/My into deg/My
nnr = [ -0.00151, 0.00484, -0.00997];
defpmm(1).data(:,4:6) = ...
   num2cell((cell2mat(defpmm(1).data(:,4:6))+repmat(nnr,[size(defpmm(1).data,1),1]))*180/pi);

% ITRF2000 (AS&B [2002]) 	Altamimi, Sillard, and Boucher [2002]

defpmm(2).model='ITRF2000';
defpmm(2).partype='wlat,wlon,rate'; 
defpmm(2).parunits='deg/My';
defpmm(2).data={ ...
   'Antarctica'    , 'AN' , 'ANTA'  ,  61.830 , -125.574 , 0.231 ; ...
   'Australia'     , 'AU' , 'AUST'  ,  32.327 ,   39.437 , 0.614 ; ...
   'Eurasia'       , 'EU' , 'EURA'  ,  57.965 ,  -99.374 , 0.260 ; ...
   'NorthAmerica'  , 'NA' , 'NOAM'  ,  -5.036 ,  -83.144 , 0.194 ; ...
   'Pacific'       , 'PA' , 'PCFC'  , -64.176 ,  110.194 , 0.666 ; ...
   'SouthAmerica'  , 'SA' , 'SOAM'  , -21.457 , -134.631 , 0.113 };
defpmm(2).orb=[0 , 0 , 0];

% ITRF2008 	Altamimi, Métivier, and Collilieux [2012]

defpmm(3).model='ITRF2008';
defpmm(3).partype='omega_xyz'; 
defpmm(3).parunits='mas/y';
defpmm(3).data={ ...
   'Amurian'       , 'AM' , 'AMUR' , -0.190 , -0.442 ,  0.915 ; ...
   'Antarctica'    , 'AN' , 'ANTA' , -0.252 , -0.302 ,  0.643 ; ...
   'Arabia'        , 'AR' , 'ARAB' ,  1.202 , -0.054 ,  1.485 ; ...
   'Australia'     , 'AU' , 'AUST' ,  1.504 ,  1.172 ,  1.228 ; ...
   'Caribbean'     , 'CA' , 'CARB' ,  0.049 , -1.088 ,  0.664 ; ...
   'Eurasia'       , 'EU' , 'EURA' , -0.083 , -0.534 ,  0.750 ; ...
   'India'         , 'IN' , 'INDI' ,  1.232 ,  0.303 ,  1.540 ; ...
   'Nazca'         , 'NZ' , 'NAZC' , -0.330 , -1.551 ,  1.625 ; ...
   'NorthAmerica'  , 'NA' , 'NOAM' ,  0.035 , -0.662 , -0.100 ; ...
   'Nubian'        , 'AF' , 'NUBI' ,  0.095 , -0.598 ,  0.723 ; ...
   'Pacific'       , 'PA' , 'PCFC' , -0.411 ,  1.036 , -2.166 ; ...
   'SouthAmerica'  , 'SA' , 'SOAM' , -0.243 , -0.311 , -0.154 ; ...
   'Somalia'       , 'SO' , 'SOMA' , -0.080 , -0.745 ,  0.897 ; ...
   'Sunda'         , 'SU' , 'SUND' ,  0.047 , -1.000 , 	0.975 };
defpmm(3).orb=[0.41 , 0.22 , 0.41 ];

% ITRF2014 	Altamimi, Rebischung, Métivier, and Collilieux [2016]

defpmm(4).model='ITRF2014';
defpmm(4).partype='omega_xyz'; 
defpmm(4).parunits='deg/My';
defpmm(4).data={ ...
   'Antarctica'    , 'AN' , 'ANTA' ,  -0.0688,   -0.0900,    0.1874 ; ...
   'Arabia'        , 'AR' , 'ARAB' ,   0.3205,   -0.0378,    0.4011 ; ...
   'Australia'     , 'AU' , 'AUST' ,   0.4194,    0.3284,    0.3375 ; ...
   'Eurasia'       , 'EU' , 'EURA' ,  -0.0235,   -0.1476,    0.2140 ; ...
   'India'         , 'IN' , 'INDI' ,   0.3205,   -0.0014,    0.4038 ; ...
   'Nazca'         , 'NZ' , 'NAZC' ,  -0.0925,   -0.4290,    0.4508 ; ...
   'NorthAmerica'  , 'NA' , 'NOAM' ,   0.0066,   -0.1928,   -0.0176 ; ...
   'Nubian'        , 'AF' , 'NUBI' ,   0.0274,   -0.1704,    0.2037 ; ...
   'Pacific'       , 'PA' , 'PCFC' ,  -0.1135,    0.2907,   -0.6025 ; ...
   'SouthAmerica'  , 'SA' , 'SOAM' ,  -0.0751,   -0.0835,   -0.0389 ; ...
   'Somalia'       , 'SO' , 'SOMA' ,  -0.0336,   -0.2206,    0.2454 };
defpmm(4).orb=[ 0.20 , 0.0 , 0.30];

% ITRF2020  Altamimi, Métivier, Rebischung, Collilieux, Chanard, and Barnéoud [2023]

defpmm(5).model='ITRF2020';
defpmm(5).partype='omega_xyz'; 
defpmm(5).parunits='deg/My';
defpmm(5).data={ ...
   'Amurian'       , 'AM' , 'AMUR' ,  -0.0364,   -0.1532,    0.2325 ; ...
   'Antarctica'    , 'AN' , 'ANTA' ,  -0.0746,   -0.0866,    0.1882 ; ...
   'Arabia'        , 'AR' , 'ARAB' ,   0.3135,   -0.0406,    0.3994 ; ...
   'Australia'     , 'AU' , 'AUST' ,   0.4132,    0.3265,    0.3398 ; ...
   'Caribbean'     , 'CA' , 'CARB' ,   0.0576,   -0.3949,    0.2017 ; ...
   'Eurasia'       , 'EU' , 'EURA' ,  -0.0237,   -0.1442,    0.2091 ; ...
   'India'         , 'IN' , 'INDI' ,   0.3159,    0.0037,    0.4010 ; ...
   'Nazca'         , 'NZ' , 'NAZC' ,  -0.0907,   -0.4336,    0.4459 ; ...
   'NorthAmerica'  , 'NA' , 'NOAM' ,   0.0126,   -0.1849,   -0.0272 ; ...
   'Nubian'        , 'AF' , 'NUBI' ,   0.0250,   -0.1625,    0.1991 ; ...
   'Pacific'       , 'PA' , 'PCFC' ,  -0.1122,    0.2836,   -0.5984 ; ...
   'SouthAmerica'  , 'SA' , 'SOAM' ,  -0.0725,   -0.0784,   -0.0437 ; ...
   'Somalia'       , 'SO' , 'SOMA' ,  -0.0225,   -0.1997,    0.2401 };
defpmm(5).orb=[ 0.37 ,  0.35 ,  0.74 ];

% GSRM v2.1 (2014) 	Kreemer, Blewitt, and Klein [2014]
%
% Kreemer, C., G. Blewitt, E.C. Klein, 2014, A geodetic plate motion and Global 
% Strain Rate Model, Geochemistry, Geophysics, Geosystems, 15, 3849-3889, 
% https://doi.org/10.1002/2014GC005407. 

defpmm(6).model='GSRM 2.1 IGS08';
defpmm(6).partype='wlat,wlon,rate'; 
defpmm(6).parunits='deg/My';
defpmm(6).data={ ...
   'Africa'        , 'AF' , 'NUBI' , 49.91 , -80.64 ,  0.267   ; ...
   'Amur'          , 'AM' , 'AMUR' , 61.85 ,-106.77 ,  0.271   ; ...
   'Antarctica'    , 'AN' , 'ANTA' , 59.16 ,-127.49 ,  0.220   ; ...
   'Arabia'        , 'AR' , 'ARAB' , 51.36 , -18.47 ,  0.465   ; ...
   'AegeanSea'     , 'AS' , '    ' , 44.80 ,  64.58 ,  0.247   ; ...
   'Australia'     , 'AU' , 'AUST' , 32.36 ,  38.00 ,  0.630   ; ...
   'BajaCalifornia', 'BC' , '    ' ,-62.53 , 105.38 ,  0.659   ; ...
   'Bering'        , 'BG' , '    ' ,-44.08 , -54.23 ,  0.331   ; ...
   'Burma'         , 'BU' , '    ' , -4.73 , -76.35 ,  2.331   ; ...
   'Caribbean'     , 'CA' , 'CARB' , 36.86 , -99.48 ,  0.274   ; ...
   'Caroline'      , 'CL' , '    ' ,-76.96 ,  36.90 ,  0.565   ; ...
   'Cocos'         , 'CO' , '    ' , 26.69 ,-124.84 ,  1.160   ; ...
   'Capricorn'     , 'CP' , '    ' , 41.48 ,  26.09 ,  0.610   ; ...
   'Danakil'       , 'DA' , '    ' , 21.53 ,  36.42 ,  2.491   ; ...
   'Easter'        , 'EA' , '    ' , 25.06 ,  67.62 , 11.331   ; ...
   'Eurasia'       , 'EU' , 'EURA' , 55.47 , -99.88 ,  0.254   ; ...
   'Galapagos'     , 'GP' , '    ' ,  2.69 ,  81.38 ,  5.482   ; ...
   'Gonave'        , 'GV' , '    ' , 22.97 , -86.10 ,  0.460   ; ...
   'India'         , 'IN' , 'INDI' , 51.01 ,  -6.26 ,  0.506   ; ...
   'JuandeFuca'    , 'JF' , '    ' ,-38.17 ,  60.51 ,  0.989   ; ...
   'JuanFernandez' , 'JZ' , '    ' , 34.30 ,  70.80 , 22.369   ; ...
   'Lwandle'       , 'LW' , '    ' , 52.96 , -61.96 ,  0.254   ; ...
   'Mariana'       , 'MA' , '    ' , 10.78 , 142.75 ,  2.177   ; ...
   'NorthAmerica'  , 'NA' , 'NOAM' , -1.40 , -86.22 ,  0.207   ; ...
   'NorthBismarck' , 'NB' , '    ' ,-30.38 , 135.26 ,  1.221   ; ...
   'Niuafo`ou'     , 'NI' , '    ' , -3.74 ,-174.25 ,  3.305   ; ...
   'Nazca'         , 'NZ' , 'NAZC' , 48.83 ,-103.93 ,  0.596   ; ...
   'Okhotsk'       , 'OK' , '    ' , 26.84 , -94.36 ,  0.194   ; ...
   'Okinawa'       , 'ON' , '    ' , 38.29 , 145.75 ,  1.365   ; ...
   'Pacific'       , 'PA' , 'PCFC' ,-62.55 , 110.70 ,  0.681   ; ...
   'Panama'        , 'PM' , '    ' , 16.16 , -84.69 ,  1.377   ; ...
   'PuertoRico'    , 'PR' , '    ' , 27.10 , -82.64 ,  0.484   ; ...
   'PhilippineSea' , 'PS' , '    ' ,-47.87 , -27.92 ,  0.895   ; ...
   'Rivera'        , 'RI' , '    ' , 20.14 ,-107.27 ,  4.498   ; ...
   'Rovuma'        , 'RO' , '    ' , 52.31 , -72.02 ,  0.251   ; ...
   'SouthAmerica'  , 'SA' , 'SOAM' ,-20.66 ,-124.97 ,  0.123   ; ...
   'SouthBismarck' , 'SB' , '    ' ,  6.81 , -32.37 ,  6.649   ; ...
   'Scotia'        , 'SC' , '    ' , 18.33 ,-105.33 ,  0.109   ; ...
   'Sinai'         , 'SI' , '    ' , 53.48 ,  -5.21 ,  0.458   ; ...
   'Sakishima'     , 'SK' , '    ' , 27.16 , 128.69 ,  7.152   ; ...
   'Shetland'      , 'SL' , '    ' , 65.40 , 133.99 ,  1.703   ; ...
   'Somalia'       , 'SO' , 'SOMA' , 47.31 , -97.20 ,  0.329   ; ...
   'SolomonSea'    , 'SS' , '    ' , -3.75 , 130.61 ,  1.688   ; ...
   'Satunam'       , 'ST' , '    ' , 36.28 , 135.28 ,  2.851   ; ...
   'Sunda'         , 'SU' , 'SUND' , 51.08 , -94.63 ,  0.333   ; ...
   'Sandwich'      , 'SW' , '    ' ,-30.91 , -35.42 ,  1.363   ; ...
   'Tonga'         , 'TO' , '    ' , 26.33 ,   4.36 ,  8.839   ; ...
   'Victoria'      , 'VI' , '    ' , 44.32 ,-105.33 ,  0.315   ; ...
   'Woodlark'      , 'WL' , '    ' , -2.00 , 130.64 ,  1.973   ; ...
   'Yangtze'       , 'YA' , '    ' , 64.79 ,-114.81 ,  0.320   };
defpmm(6).orb=[0 , 0 , 0];

defpmm(7).model='GSRM 2.1 NNR';
defpmm(7).partype='wlat,wlon,rate'; 
defpmm(7).parunits='deg/My';
defpmm(7).data={ ...
   'Africa'        , 'AF' , 'NUBI' , 49.66 , -78.08 ,  0.285  ; ...
   'Amur'          , 'AM' , 'AMUR' , 61.64 ,-101.29 ,  0.287  ; ...
   'Antarctica'    , 'AN' , 'ANTA' , 60.08 ,-120.14 ,  0.234  ; ...
   'Arabia'        , 'AR' , 'ARAB' , 51.12 , -19.87 ,  0.484  ; ...
   'AegeanSea'     , 'AS' , '    ' , 47.78 ,  59.86 ,  0.253  ; ...
   'Australia'     , 'AU' , 'AUST' , 33.31 ,  36.38 ,  0.639  ; ...
   'BajaCalifornia', 'BC' , '    ' ,-63.04 , 104.02 ,  0.640  ; ...
   'Bering'        , 'BG' , '    ' ,-40.62 , -53.84 ,  0.333  ; ...
   'Burma'         , 'BU' , '    ' , -4.38 , -76.17 ,  2.343  ; ...
   'Caribbean'     , 'CA' , 'CARB' , 37.84 , -96.49 ,  0.290  ; ...
   'Caroline'      , 'CL' , '    ' ,-76.41 ,  30.22 ,  0.552  ; ...
   'Cocos'         , 'CO' , '    ' , 27.21 ,-124.02 ,  1.169  ; ...
   'Capricorn'     , 'CP' , '    ' , 42.13 ,  24.28 ,  0.622  ; ...
   'Danakil'       , 'DA' , '    ' , 21.80 ,  36.05 ,  2.497  ; ...
   'Easter'        , 'EA' , '    ' , 25.14 ,  67.55 , 11.331  ; ...
   'Eurasia'       , 'EU' , 'EURA' , 55.38 , -95.41 ,  0.271  ; ...
   'Galapagos'     , 'GP' , '    ' ,  2.83 ,  81.26 ,  5.473  ; ...
   'Gonave'        , 'GV' , '    ' , 23.89 , -84.86 ,  0.476  ; ...
   'India'         , 'IN' , 'INDI' , 50.95 ,  -8.00 ,  0.524  ; ...
   'JuandeFuca'    , 'JF' , '    ' ,-37.71 ,  59.44 ,  0.977  ; ...
   'JuanFernandez' , 'JZ' , '    ' , 34.33 ,  70.76 , 22.370  ; ...
   'Lwandle'       , 'LW' , '    ' , 52.20 , -60.68 ,  0.273  ; ...
   'Mariana'       , 'MA' , '    ' , 11.20 , 142.82 ,  2.165  ; ...
   'NorthAmerica'  , 'NA' , 'NOAM' ,  2.19 , -83.75 ,  0.219  ; ...
   'NorthBismarck' , 'NB' , '    ' ,-30.20 , 135.30 ,  1.201  ; ...
   'Niuafo`ou'     , 'NI' , '    ' , -3.51 ,-174.04 ,  3.296  ; ...
   'Nazca'         , 'NZ' , 'NAZC' , 49.05 ,-102.13 ,  0.611  ; ...
   'Okhotsk'       , 'OK' , '    ' , 28.80 , -90.91 ,  0.209  ; ...
   'Okinawa'       , 'ON' , '    ' , 39.11 , 145.94 ,  1.361  ; ...
   'Pacific'       , 'PA' , 'PCFC' ,-63.09 , 109.63 ,  0.663  ; ...
   'Panama'        , 'PM' , '    ' , 16.55 , -84.30 ,  1.392  ; ...
   'PuertoRico'    , 'PR' , '    ' , 27.81 , -81.51 ,  0.502  ; ...
   'PhilippineSea' , 'PS' , '    ' ,-46.62 , -28.39 ,  0.895  ; ...
   'Rivera'        , 'RI' , '    ' , 20.27 ,-107.10 ,  4.510  ; ...
   'Rovuma'        , 'RO' , '    ' , 51.72 , -69.88 ,  0.270  ; ...
   'SouthAmerica'  , 'SA' , 'SOAM' ,-14.10 ,-117.86 ,  0.123  ; ...
   'SouthBismarck' , 'SB' , '    ' ,  6.91 , -32.41 ,  6.665  ; ...
   'Scotia'        , 'SC' , '    ' , 23.02 , -98.78 ,  0.122  ; ...
   'Sinai'         , 'SI' , '    ' , 53.34 ,  -7.27 ,  0.476  ; ...
   'Sakishima'     , 'SK' , '    ' , 27.31 , 128.68 ,  7.145  ; ...
   'Shetland'      , 'SL' , '    ' , 66.05 , 134.03 ,  1.710  ; ...
   'Somalia'       , 'SO' , 'SOMA' , 47.59 , -94.36 ,  0.346  ; ...
   'SolomonSea'    , 'SS' , '    ' , -3.33 , 130.60 ,  1.672  ; ...
   'Satunam'       , 'ST' , '    ' , 36.68 , 135.30 ,  2.846  ; ...
   'Sunda'         , 'SU' , 'SUND' , 51.11 , -91.75 ,  0.350  ; ...
   'Sandwich'      , 'SW' , '    ' ,-30.11 , -35.58 ,  1.369  ; ...
   'Tonga'         , 'TO' , '    ' , 26.38 ,   4.27 ,  8.853  ; ...
   'Victoria'      , 'VI' , '    ' , 44.96 ,-102.19 ,  0.330  ; ...
   'Woodlark'      , 'WL' , '    ' , -1.62 , 130.63 ,  1.957  ; ...
   'Yangtze'       , 'YA' , '    ' , 64.76 ,-109.19 ,  0.335  };
defpmm(7).orb=[0 , 0 , 0];

nummodel=find(ismember({ defpmm.model },pmm));
if ~isscalar(nummodel)
   error(['Plate motion model ' pmm ' unavailable'])
end

plates = defpmm(nummodel).data(:,1:3);
data = cell2mat(defpmm(nummodel).data(:,4:6));
[numplate,~]=find(ismember(plates,tecplate));
if ~isscalar(numplate)
   error(['Tectonic plate ' tecplate ' unavailable'])
end

if strcmpi(defpmm(nummodel).partype,'omega_xyz')
   if strcmpi(defpmm(nummodel).parunits,'deg/My')
      omega_xyz = data(numplate,:)';
   elseif strcmpi(defpmm(nummodel).parunits,'mas/y')
      omega_xyz = 3.6 * data(numplate,:)';
   else
      error('Unsupported parameter unit')
   end
elseif strcmpi(defpmm(nummodel).partype,'wlat,wlon,rate')
   pmmpole = data(numplate,:);
   if strcmpi(defpmm(nummodel).parunits,'deg/My')
      omega = pmmpole(3);
   elseif strcmpi(defpmm(nummodel).parunits,'mas/y')
      omega = 3.6 * pmmpole(3);
   else
      error('Unsupported parameter unit')
   end
   omega_xyz = [ cosd(pmmpole(1))*cosd(pmmpole(2)) ; cosd(pmmpole(1))*sind(pmmpole(2)) ; sind(pmmpole(1)) ] * omega;
else
   error('Unsupported parameter type')
end
orb = defpmm(nummodel).orb;

end
